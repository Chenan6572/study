define(function(require) {
	var $ = require("jquery");
	var justep = require("$UI/system/lib/justep");
	require("$UI/zupu/js/date/datePicker");
	require("css!$UI/zupu/css/LCalendar").load();
	var calendar = new datePicker();
	calendar.init({
		'trigger' : '#date', /* 按钮选择器，用于触发弹出插件 */
		'type' : 'date',/* 模式：date日期；datetime日期时间；time时间；ym年月； */
		'minDate' : '1900-1-1',/* 最小日期 */
		'maxDate' : '2100-12-31',/* 最大日期 */
		'onSubmit' : function() {/* 确认时触发事件 */
			var theSelectData = calendar.value;
		},
		'onClose' : function() {/* 取消时触发事件 */
		}
	});

	var Model = function() {
		this.callParent();
	};

	Model.prototype.btnSaveMarry = function(event) {

		var userid = localStorage.getItem("ID");

		var a = "", b = "", c = "", sexIndex = -1;
		selIndex = this.getElementByXid("inMarried").selectedIndex;
		if (selIndex >= 0)
			a = this.getElementByXid("inMarried").options[selIndex].text;

		selIndex = this.getElementByXid("inMarriedReleation").selectedIndex;
		if (selIndex >= 0)
			b = this.getElementByXid("inMarriedReleation").options[selIndex].text;

		c = this.comp("inMarriedFirst").val();

		var data = this.comp("baasData1");
		if (data.find([ 'Id' ], [ userid ]).length === 0) {
			data.newData({
				"defaultValues" : // array - 新增行的默认值数组
									// ，数组的长度决定新增行数，数组中的对象是列的默认值
				[ {
					Id : userid,
					married : a,
					marriedFirst : c,
					marriedReleation : b
				} ],
				"onError" : function(e) {
				},
				"onSuccess" : function(e) {
				}
			});
			var option = {
				"onSuccess" : function(e) {
					justep.Util.hint("保存成功！", {
						type : 'danger'
					});
				}
			};
			data.saveData(option);

		} else {
			var row = data.getFirstRow();
			data.setValue("married", a, row);
			data.setValue("marriedReleation", b, row);
			data.setValue("marriedFirst", c, row);
			var option = {
				"onSuccess" : function(e) {
					justep.Util.hint("保存成功!!！", {
						type : 'danger'
					});
				}
			};
			data.saveData(option);
		}
		justep.Shell.fireEvent("onMarryChanged", {
			"classData" : "abc"
		});
		justep.Shell.closePage();

	};

	return Model;
});