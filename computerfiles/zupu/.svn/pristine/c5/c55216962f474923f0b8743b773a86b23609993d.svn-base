//var perid = "";
define(function(require) {
	var $ = require("jquery");
	var justep = require("$UI/system/lib/justep");
	var Vue = require("$UI/zupu/js/vue");
	var Model = function() {
		this.callParent();
	};
	// 页面激活方法
	Model.prototype.modelActive = function(event) {
		// 访问后台数据
		var loginName = localStorage.getItem("loginName");
		console.log("进入页面激活方法");
		$.ajax({
			headers : {
				Authorization : "Bearer " + localStorage.getItem('Token'),
			},
			url : 'http://10.10.1.232:8088/YProject/api/query?login_name=' + loginName,
			processData : false,
			cache : false,
			async : false,
			global : false,
			contentType : "application/json; charset=utf-8",
			datatype : "json",
			type : 'post',
			success : function(res) {
				console.log("打印数据");
				console.log(res.data);
				console.log(res.data);
				$("#nameone").html(res.data.name); //姓名
				$("#doornum").html(res.data.doornum);//户号
				$("#birthday").html(res.data.birthday);//生日
				$("#address").html(res.data.address);//地址
				//手机号加密处理
				//res.data.phone.replace(/(\d{3})(\d{5})(\d{3})/, "$1*****$3");			
				$("#phone").html(res.data.phone.replace(/(\d{3})(\d{5})(\d{3})/, "$1*****$3"));//电话
				$("#nowaddress").html(res.data.nowaddress)//现住址
				$("#address").html(res.data.address)//户籍住址
				$("#register_category").html(res.data.register_category)//户籍类型
				// 使用Vue渲染教育列表
				new Vue({
					el : '.app1',
					data : {
						datas : []
					},
					created : function() {
						this.datas = res.data.zEducationInfoList;
						console.log(this.datas);
					}
				});
				// 使用Vue渲染工作列表
					new Vue({
					el : '.app2',
					data : {
						datas : []
					},
					created : function() {
						this.datas = res.data.zWorkExperienceList;
						console.log(this.datas);
					}
				});
			},
			error : function(res) {
				justep.Util.hint(res.message, {
					type : 'danger',
				});
				console.log("测试失败");
			},
		});
		// 编辑教育信息
		$(".div4Click").on('click', function() {
			var listid = $(this).text();
			console.log(listid);
			justep.Shell.showPage("bindeditedu",{child:listid});
		});
		// 编辑工作经理
		$(".div5Click").on('click', function() {
			justep.Shell.showPage("bindeditwork");
		});
	};
	// 进入onload方法
	Model.prototype.onload = function(event) {
		// 访问后台数据
		var loginName = localStorage.getItem("loginName");
		console.log("进入onload方法");
		$.ajax({
			headers : {
				Authorization : "Bearer " + localStorage.getItem('Token'),
			},
			url : 'http://10.10.1.232:8088/YProject/api/query?login_name=' + loginName,
			processData : false,
			cache : false,
			async : false,
			global : false,
			contentType : "application/json; charset=utf-8",
			datatype : "json",
			type : 'post',
			success : function(res) {
				console.log("打印数据");
				console.log(res.data);
				console.log(res.data);
				$("#nameone").html(res.data.name); //姓名
				$("#doornum").html(res.data.doornum);//户号
				$("#birthday").html(res.data.birthday);//生日
				$("#address").html(res.data.address);//地址
				//手机号加密处理
				//res.data.phone.replace(/(\d{3})(\d{5})(\d{3})/, "$1*****$3");			
				$("#phone").html(res.data.phone.replace(/(\d{3})(\d{5})(\d{3})/, "$1*****$3"));//电话
				$("#nowaddress").html(res.data.nowaddress)//现住址
				$("#address").html(res.data.address)//户籍住址
				$("#register_category").html(res.data.register_category)//户籍类型
				// 使用Vue渲染列表
				new Vue({
					el : '.app1',
					data : {
						datas : []
					},
					created : function() {
						this.datas = res.data.zEducationInfoList;
						console.log(this.datas);
					}
				});
				// 使用Vue渲染工作列表
					new Vue({
					el : '.app2',
					data : {
						datas : []
					},
					created : function() {
						this.datas = res.data.zWorkExperienceList;
						console.log(this.datas);
					}
				});
			},
			error : function(res) {
				justep.Util.hint(res.message, {
					type : 'danger',
				});
				console.log("测试失败");
			}
		});
		// 编辑教育信息
//		$(".div4Click").click(function(e) {	
//			var listid = $(this).text();
//			justep.Shell.showPage("bindeditedu",{child:listid});
//		});
		$(".div4Click").on('click', function() {
			var listid = $(this).text();
			console.log(listid);
			justep.Shell.showPage("bindeditedu",{child:listid});
		});
		// 编辑工作经理
		$(".div5Click").on('click', function() {
			justep.Shell.showPage("bindeditwork");
		});
	}

	// 跳转个人信息页
	Model.prototype.div1Click = function(event) {
		justep.Shell.showPage("jibenxinxi");
	};
	// 修改手机号
	Model.prototype.div2Click = function(event) {
		justep.Shell.showPage("bindphone");
	};
	// 编辑户籍信息
	Model.prototype.div3Click = function(event) {
		justep.Shell.showPage("bindhuji");
	};
	// 添加教育信息
	Model.prototype.sumedu = function(event) {
		justep.Shell.showPage("bindaddedu");
	};
	// 添加工作经历
	Model.prototype.sumwork = function(event) {
		justep.Shell.showPage("bindaddwork");
	};

	Model.prototype.modelParamsReceive = function(event) {
		// console.log("测试接收子页面数据 = "+this.params.name);
		// $("#name").val(this.params.name);
	};
	return Model;
});
/*
 * //图片路径 var img1url = "$UI/zupu/img/edua.png"; //编辑教育信息 function editedu(id) {
 * justep.Shell.showPage("bindeditedu",{ chlidid:id, perid:perid }); } //编辑工作经历
 * function editwork(id) { justep.Shell.showPage("bindeditwork",{ chlidid:id,
 * perid:perid });
 *  }
 */